{% extends 'base.html' %}

{% block title %}
  Access Files - Cyberpress
{% endblock %}

{% block content %}
  <div class="row justify-content-center">
    <div class="col-lg-6 col-md-8">
      <div class="modern-card p-5">
        <!-- Header -->
        <div class="text-center mb-4">
          <i class="bi bi-shield-lock fs-1 text-primary mb-3"></i>
          <h2 class="fw-bold">Access Your Files</h2>
          <p class="text-muted">Enter your passkey to retrieve files.</p>
        </div>

        <!-- Error Message -->
        {% if error %}
          <div class="alert alert-danger text-center">
            <i class="bi bi-exclamation-triangle"></i>
            {{ error }}
          </div>
        {% endif %}

        <!-- Files List -->
        {% if files %}
          <h5 class="fw-bold mb-3 text-center">Session Files</h5>

          <div class="mb-4">
            {% for file in files %}
              <div class="file-download-card d-flex justify-content-between align-items-center mb-3 p-3 border rounded">
                <div>
                  <i class="bi bi-file-earmark-pdf text-danger me-2"></i>
                  <strong>{{ file.name }}</strong>
                  <div class="small text-muted">{{ file.size|floatformat:1 }} bytes</div>
                </div>
                <a href="{{ file.file.url }}" target="_blank" class="btn btn-primary rounded-pill px-4" download><i class="bi bi-download"></i></a>
              </div>
            {% endfor %}
          </div>

          <div class="alert alert-warning text-center small">‚è≥ Files auto-delete 24 hours after upload.</div>
        {% else %}
          <form method="post" novalidate>
            {% csrf_token %}

            <div class="mb-4">
              <label class="form-label fw-semibold">Access Code</label>
              <div class="input-group input-group-lg">
                {{ form.access_code }}
                <button class="btn btn-outline-secondary" type="button" id="toggleAccessPasskey"><i class="bi bi-eye"></i></button>
              </div>
            </div>

            <button type="submit" class="btn btn-primary btn-lg w-100 rounded-pill py-3 fw-bold">
              <i class="bi bi-unlock"></i>
              Unlock Files
            </button>
          </form>
        {% endif %}
      </div>
    </div>
  </div>
{% endblock %}
